\begin{tikzpicture}[scale = 0.6]
%
%\pgfdeclarelayer{bg}    % declare background layer
%\pgfsetlayers{bg,main}  % set the order of the layers (main is the standard layer)
%Koordinaten & Knoten
	\coordinate (origin) at (-0.5,-0.5);
	
\def \t {1.2}
	
	\coordinate (c1) at (1*\t,1*\t);
	\coordinate (c2) at (3*\t,1*\t);
	\coordinate (c3) at (5*\t,1*\t);
	\coordinate (c4) at (7*\t,1*\t);
	\coordinate (c5) at (9*\t,1*\t);
	
	\coordinate (c6) at (1*\t,3*\t);
	\coordinate (c7) at (3*\t,3*\t);
	\coordinate (c8) at (5*\t,3*\t);
	\coordinate (c9) at (7*\t,3*\t);
	\coordinate (c10) at (9*\t,3*\t);
	
	\coordinate (c11) at (1*\t,5*\t);
	\coordinate (c12) at (3*\t,5*\t);
	\coordinate (c13) at (5*\t,5*\t);
	\coordinate (c14) at (7*\t,5*\t);
	\coordinate (c15) at (9*\t,5*\t);
	
	\coordinate (c16) at (1*\t,7*\t);
	\coordinate (c17) at (3*\t,7*\t);
	\coordinate (c18) at (5*\t,7*\t);
	\coordinate (c19) at (7*\t,7*\t);
	\coordinate (c20) at (9*\t,7*\t);	
	
%	\coordinate (c21) at (1,9);
%	\coordinate (c22) at (3,9);
%	\coordinate (c23) at (5,9);
%	\coordinate (c24) at (7,9);
%	\coordinate (c25) at (9,9);	
	
	
 
	\coordinate (d1) at (1*\t,1);	
	\coordinate (d2) at (2*\t,1*\t);
	\coordinate (d3) at (4*\t,1*\t);
	\coordinate (d4) at (6*\t,1*\t);
	\coordinate (d5) at (8*\t,1*\t);	
	\coordinate (d6) at (9*\t,1*\t);
		
	\coordinate (d7) at (1*\t,2*\t);	
	\coordinate (d8) at (2*\t,2*\t);
	\coordinate (d9) at (4*\t,2*\t);
	\coordinate (d10) at (6*\t,2*\t);
	\coordinate (d11) at (8*\t,2*\t);
	\coordinate (d12) at (9*\t,2*\t);
	
	\coordinate (d13) at (1*\t,4*\t);
	\coordinate (d14) at (2*\t,4*\t);
	\coordinate (d15) at (4*\t,4*\t);
	\coordinate (d16) at (6*\t,4*\t);
	\coordinate (d17) at (8*\t,4*\t);
	\coordinate (d18) at (9*\t,4*\t);
	
	\coordinate (d19) at (1*\t,6*\t);
	\coordinate (d20) at (2*\t,6*\t);
	\coordinate (d21) at (4*\t,6*\t);
	\coordinate (d22) at (6*\t,6*\t);
	\coordinate (d23) at (8*\t,6*\t);
	\coordinate (d24) at (9*\t,6*\t);
	
	\coordinate (d25) at (1*\t,7*\t);
	\coordinate (d26) at (2*\t,7*\t);
	\coordinate (d27) at (4*\t,7*\t);
	\coordinate (d28) at (6*\t,7*\t);
	\coordinate (d29) at (8*\t,7*\t);
	\coordinate (d30) at (9*\t,7*\t);
	
	\coordinate (legend) at (11*\t,7*\t); 
	
%	\coordinate (d31) at (1,9);
%	\coordinate (d32) at (2,9);
%	\coordinate (d33) at (4,9);
%	\coordinate (d34) at (6,9);
%	\coordinate (d35) at (8,9);
%	\coordinate (d36) at (9,9);
	
	\coordinate (fieldorigin) at (c13);

%Achsen
	\draw [->] (origin) -- ++(2,0) node [below] {$x$};
	\draw [->] (origin) -- ++(0,2) node [left] {$y$};


 
 
 
 % qn und phin
% \begin{pgfonlayer}{main} 
%	\node [above right] at (d36) {{\scriptsize $\varphi_n$}}; 
%	\node [] at ($0.5*(d29)+0.5*(d36)$) {{\scriptsize $q_n$}}; 	
% \end{pgfonlayer} 
 \begin{pgfonlayer}{b1} 
	\fill [lightred] (d20) rectangle (d15);
 \end{pgfonlayer}{b1} 
 
 \begin{pgfonlayer}{b2} 
 	\draw [-, line width=0.5mm] (c11) -- (c13);	
 	\draw [-, line width=0.5mm] (c7) -- (c17);	
\end{pgfonlayer}{b2} 

\def \la {-5}

\def \lin {1.2}

\node [] at ($(c11)+(\la,\lin+0.5)$) {{ $\left(\Phi_n - \Phi_{n+M_y} \right)$}};
\draw [-, line width=0.2mm] ($0.5*(c12)+0.5*(c17)+(0,0)$) -- ($(c11)+(\la+2,\lin+0.5)$);

\node [] at ($(c11)+(\la,0.5)$) {{ $\left(\Phi_n - \Phi_{n-M_x} \right)$}};
\draw [-, line width=0.2mm] ($0.5*(c11)+0.5*(c12)+(0,0)$) -- ($(c11)+(\la+2,0.5)$);	

\node [] at ($(c11)+(\la,-\lin+0.5)$) {{ $\left(\Phi_n - \Phi_{n+M_x} \right)$}};
\draw [-, line width=0.2mm] ($0.5*(c12)+0.5*(c13)+(0,0)$) -- ($(c11)+(\la+2,-\lin+0.5)$);	

\node [] at ($(c11)+(\la,-\lin-\lin+0.5)$) {{ $\left(\Phi_n - \Phi_{n-M_y} \right)$}};
\draw [-, line width=0.2mm] ($0.5*(c12)+0.5*(c7)+(0,0)$) -- ($(c11)+(\la+2,-\lin-\lin+0.5)$);	

\def \ab {1.3}
\def \rig {0.0}

\node [] at ($(d27)+(\rig,\ab)$) {{ $\Phi_n$}};
\draw [-, line width=0.2mm] ($(c12)+(0.15,0.15)$) -- ($(d27)+(\rig,\ab-0.3)$);	

\node [] at ($(d27)+(\rig+1,\ab)$) {{ $\mathbf{q}_n$}};
\draw [-, red, line width=0.2mm] ($(c12)+(0.5,0.5)$) -- ($(d27)+(\rig+1,\ab-0.3)$);	 

%Primäres Gitter
	%horizontal
	\draw [-] (c1) -- (c5);	
	\draw [-] (c6) -- (c10);		
	\draw [-] (c11) -- (c15);		
	\draw [-] (c16) -- (c20);		
%	\draw [-] (c21) -- (c25);		
		
%	\node [below, blue] at (2, 1) {{\scriptsize 1}}; 
	
	\draw [-] (c1) -- (c16);
	\draw [-] (c2) -- (c17);
	\draw [-] (c3) -- (c18);
	\draw [-] (c4) -- (c19);
	\draw [-] (c5) -- (c20);
	
 
%Duales Gitter
	%horizontal
	\draw [-, red] (d7) -- (d12);	
	\draw [-, red] (d13) -- (d18);	
	\draw [-, red] (d19) -- (d24);	
%	\draw [-, red] (d25) -- (d30);
	 
	%vertikal
	
	\draw [-, red] (d2) -- (d26);
	\draw [-, red] (d3) -- (d27);
	\draw [-, red] (d4) -- (d28);
	\draw [-, red] (d5) -- (d29);

%Knoten

	\foreach \i in {1,...,20}{
    	\draw[mark=*] plot coordinates {(c\i)} ; 
    }
    
    \foreach \i in {8,9,10,11,12, 14,15,16,17,18, 20,21,22,23,24, 26,27,28,29,30}{
    	\draw[mark=*, red] plot coordinates {(d\i)} ; 
    }
	
\tikzset{
  mybackground/.style={execute at end picture={
        \begin{scope}[on background layer]
          \draw[black!15,fill=black!5,rounded corners=1ex] (c7) rectangle (c15);
%          \node[draw,fill=olive,ellipse,anchor=west,inner sep=1pt,minimum width=4ex] at (c9){#1};
        \end{scope}
    }},
}
 
	
	
%Feldursprung

%	\draw[mark=*] plot coordinates {(fieldorigin)} ;
%	\node [below right] at (fieldorigin) {{\scriptsize O}}; 
	
%	\node [red] at (11,6.5) {{ \scriptsize \begin{tabular}{cc} $i_{Mitte}=3$  \\ $j_{Mitte}=3$ \\ \end{tabular} }}; 
%	\draw [-, red] (10,6.5) -- (6.1,6.1);

 

%indizierung
%	\draw [-, red, line width=0.4mm] (d2) -- (d8);	
%	\node [below, red] at (d2) {{ \scriptsize \begin{tabular}{cc} $i_{\widetilde{y}}=1$  \\ $j_{\widetilde{y}}=1$ \\ \end{tabular} }}; 
%	\node [below, red] at (d3) {{ \scriptsize \begin{tabular}{cc} $i_{\widetilde{x}}=2$  \\ $j_{\widetilde{x}}=1$ \\ \end{tabular} }}; 
%	\node [below, red] at (d4) {{ \scriptsize \begin{tabular}{cc} $i_{\widetilde{x}}=3$  \\ $j_{\widetilde{x}}=1$ \\ \end{tabular} }}; 
%	\node [below, red] at (d5) {{ \scriptsize \begin{tabular}{cc} $i_{\widetilde{x}}=4$  \\ $j_{\widetilde{x}}=1$ \\ \end{tabular} }};  
%	\draw [-, red, line width=0.4mm] (d7) -- (d8);	
%	\node [left, red] at (d7) {{ \scriptsize \begin{tabular}{cc} $i_{\widetilde{x}}=1$  \\ $j_{\widetilde{x}}=1$ \\ \end{tabular} }}; 	
%	\node [right, red] at (d12) {{ \scriptsize \begin{tabular}{cc} $i_{\widetilde{y}}=5$  \\ $j_{\widetilde{y}}=1$ \\ \end{tabular} }}; 
	
%Legend

	\def \line {0.8}

	\draw [-] (legend) -- ($(legend)+(1,0)$);
	\draw[mark=*] plot coordinates {($(legend)+(0.5,0)$)} ; 
	\node [right] at ($(legend)+(1.3,0)$) {{ \scriptsize Primäres Gitter }};
	
	\draw [-, red] ($(legend)+(0,-\line)$) -- ($(legend)+(1,-\line)$);
	\draw[mark=*, red] plot coordinates {($(legend)+(0.5,-\line)$)} ; 
	\node [right] at ($(legend)+(1.3,-\line)$) {{ \scriptsize Duales Gitter }};
 


\end{tikzpicture}